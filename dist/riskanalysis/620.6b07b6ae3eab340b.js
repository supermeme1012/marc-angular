"use strict";(self.webpackChunkriskanalysis=self.webpackChunkriskanalysis||[]).push([[620],{4620:(nt,S,n)=>{n.r(S),n.d(S,{LdapTitleModule:()=>ot});var d=n(6895),g=n(7579),h=n(4004),f=n(2722),T=n(8505),v=n(262),x=n(2843),a=n(4006),t=n(4650),b=n(6693),y=n(9439),F=n(6284),Z=n(7404),r=n(5412),C=n(805),p=n(9549),w=n(8271),Y=n(1149),_=n(4144),L=n(4859);function j(i,l){if(1&i&&(t.TgZ(0,"div",14)(1,"div",15)(2,"span",16),t._uU(3),t.qZA()()()),2&i){const e=l.$implicit;t.xp6(3),t.Oqu(e.roleName)}}const R=function(){return{height:"20rem"}};function Q(i,l){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",4)(2,"mat-dialog-content")(3,"div",5)(4,"mat-form-field")(5,"mat-label"),t._uU(6,"Ldap Title"),t.qZA(),t._UZ(7,"input",6),t.TgZ(8,"mat-error"),t._UZ(9,"form-error",7),t.qZA()(),t.TgZ(10,"div",8)(11,"label"),t._uU(12,"Select Roles"),t.qZA(),t.TgZ(13,"p-pickList",9),t.YNc(14,j,4,1,"ng-template",10),t.qZA()()()(),t.TgZ(15,"mat-dialog-actions",11)(16,"button",12),t._uU(17,"Cancel"),t.qZA(),t.TgZ(18,"button",13),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.store())}),t._uU(19,"Save"),t.qZA()()(),t.BQk()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(8),t.Q6J("form",e.form),t.xp6(4),t.Q6J("source",e.roles)("target",e.targetRoles)("dragdrop",!0)("responsive",!0)("sourceStyle",t.DdM(9,R))("targetStyle",t.DdM(10,R)),t.xp6(5),t.Q6J("disabled",!e.form.valid)}}function D(i,l){1&i&&t._uU(0,"Please wait...")}let E=(()=>{class i{constructor(e,o,s,c,u,A){this.apiService=e,this.passwordService=o,this.formBuilder=s,this.formValidation=c,this.notificationService=u,this.dialogRef=A,this.subject=new g.x,this.targetRoles=[]}ngOnInit(){this.initFormFields()}initFormFields(){this.form$=this.apiService.initNewLdapTitleForm().pipe((0,h.U)(e=>(this.roles=e.data,this.createForm())))}createForm(){return this.form=this.formBuilder.group({ldapTitle:["",[a.kI.required]],roles:[""]}),this.form}store(){this.form.value.roles=this.targetRoles.map(e=>e.id),this.apiService.storeLdapTitle(this.form.value).pipe((0,T.b)(e=>{this.notificationService.show(e),this.dialogRef.close(!0)}),(0,v.K)(e=>(this.formValidation.validateAllFields(this.form,e.error.data),(0,x._)(()=>e))),(0,f.R)(this.subject)).subscribe()}ngOnDestroy(){this.subject.next(!0),this.subject.complete()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(b.N),t.Y36(y.C),t.Y36(a.qu),t.Y36(F.m),t.Y36(Z.g),t.Y36(r.so))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-add-ldap-title"]],decls:7,vars:4,consts:[[1,"flex-auto","p-5"],["mat-dialog-title",""],[4,"ngIf","ngIfElse"],["loading",""],[1,"mt-8",3,"formGroup"],[1,"flex","flex-col","col-span-2","flex-auto"],["matInput","","type","text","formControlName","ldapTitle"],["name","ldapTitle",3,"form"],[1,"flex","flex-col","mb-5"],["sourceHeader","Available","targetHeader","Selected","filterBy","roleName","sourceFilterPlaceholder","Search by name","targetFilterPlaceholder","Search by name",3,"source","target","dragdrop","responsive","sourceStyle","targetStyle"],["pTemplate","item"],["align","end"],["mat-button","","mat-dialog-close",""],["mat-button","",3,"disabled","click"],[1,"product-item"],[1,"product-list-detail"],[1,"mb-2"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"h2",1),t._uU(2,"Create Ldap Title"),t.qZA(),t.YNc(3,Q,20,11,"ng-container",2),t.ALo(4,"async"),t.YNc(5,D,1,0,"ng-template",null,3,t.W1O),t.qZA()),2&e){const s=t.MAs(6);t.xp6(3),t.Q6J("ngIf",t.lcZ(4,2,o.form$))("ngIfElse",s)}},dependencies:[d.O5,C.jx,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,p.TO,p.KE,p.hX,w.A,Y.G,_.Nt,r.ZT,r.uh,r.xY,r.H8,L.lW,d.Ov],encapsulation:2}),i})();var U=n(5722);const O=function(){return{width:"100%"}};function $(i,l){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",4)(2,"mat-dialog-content",5)(3,"div",6)(4,"mat-form-field")(5,"mat-label"),t._uU(6,"Ldap Title"),t.qZA(),t._UZ(7,"input",7),t.TgZ(8,"mat-error"),t._UZ(9,"form-error",8),t.qZA()(),t.TgZ(10,"div",9)(11,"label"),t._uU(12,"Select Roles"),t.qZA(),t._UZ(13,"p-multiSelect",10),t.qZA()()(),t.TgZ(14,"mat-dialog-actions",11)(15,"button",12),t._uU(16,"Cancel"),t.qZA(),t.TgZ(17,"button",13),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.update())}),t._uU(18,"Save"),t.qZA()()(),t.BQk()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(8),t.Q6J("form",e.form),t.xp6(4),t.Akn(t.DdM(6,O)),t.Q6J("options",e.roles),t.xp6(4),t.Q6J("disabled",!e.form.valid)}}function M(i,l){1&i&&t._uU(0,"Please wait...")}let B=(()=>{class i{constructor(e,o,s,c,u,A,lt){this.dialogData=e,this.apiService=o,this.passwordService=s,this.formBuilder=c,this.formValidation=u,this.notificationService=A,this.dialogRef=lt,this.subject=new g.x,this.targetRoles=[]}ngOnInit(){this.initFormFields(this.dialogData.title)}initFormFields(e){this.form$=this.apiService.initEditLdapTitleForm(e).pipe((0,h.U)(o=>(this.roles=o.data.roles,this.createForm(o.data.roleLdapTitle))))}createForm(e){return this.form=this.formBuilder.group({oldTitle:[e.ldapTitle],ldapTitle:[e.ldapTitle,[a.kI.required]],roles:[e.roles.map(o=>o.id)]}),this.form}update(){this.apiService.updateLdapTitle(this.form.value).pipe((0,T.b)(e=>{this.notificationService.show(e),this.dialogRef.close(!0)}),(0,v.K)(e=>(this.formValidation.validateAllFields(this.form,e.error.data),(0,x._)(()=>e))),(0,f.R)(this.subject)).subscribe()}ngOnDestroy(){this.subject.next(!0),this.subject.complete()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(r.WI),t.Y36(b.N),t.Y36(y.C),t.Y36(a.qu),t.Y36(F.m),t.Y36(Z.g),t.Y36(r.so))},i.\u0275cmp=t.Xpm({type:i,selectors:[["edit-ldap-title"]],decls:7,vars:4,consts:[[1,"flex-auto","p-5"],["mat-dialog-title",""],[4,"ngIf","ngIfElse"],["loading",""],[1,"mt-8",3,"formGroup"],[1,"h-120"],[1,"flex","flex-col","flex-auto"],["matInput","","type","text","formControlName","ldapTitle"],["name","ldapTitle",3,"form"],[1,"flex","flex-col","mb-5","w-auto"],["formControlName","roles","optionLabel","roleName","optionValue","id","selectedItemsLabel","{0} columns selected","placeholder","Select Roles",3,"options"],["align","end"],["mat-button","","mat-dialog-close",""],["mat-button","",3,"disabled","click"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"h2",1),t._uU(2,"Manage Ldap Title"),t.qZA(),t.YNc(3,$,19,7,"ng-container",2),t.ALo(4,"async"),t.YNc(5,M,1,0,"ng-template",null,3,t.W1O),t.qZA()),2&e){const s=t.MAs(6);t.xp6(3),t.Q6J("ngIf",t.lcZ(4,2,o.form$))("ngIfElse",s)}},dependencies:[d.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,p.TO,p.KE,p.hX,w.A,_.Nt,r.ZT,r.uh,r.xY,r.H8,L.lW,U.NU,d.Ov],encapsulation:2}),i})();var J=n(2510),m=n(403),N=n(5593),I=n(1327);function K(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"div",9)(1,"button",10),t.NdJ("click",function(s){t.CHM(e);const c=t.MAs(3);return t.KtG(c.toggle(s))}),t.qZA(),t._UZ(2,"p-menu",11,12),t.qZA()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("popup",!0)("model",e.menuItems)}}function P(i,l){if(1&i&&(t.TgZ(0,"th",14),t._uU(1),t._UZ(2,"p-sortIcon",15),t.qZA()),2&i){const e=l.$implicit;t.s9C("pSortableColumn",e.field),t.xp6(1),t.hij(" ",e.header," "),t.xp6(1),t.s9C("field",e.field)}}function G(i,l){if(1&i&&(t.TgZ(0,"tr"),t.YNc(1,P,3,3,"th",13),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.cols)}}const H=function(i,l){return{"true-icon pi-check-circle":i,"false-icon pi-times-circle":l}};function q(i,l){if(1&i&&(t.TgZ(0,"td"),t._UZ(1,"i",20),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.Q6J("ngClass",t.WLB(1,H,o[e.field],!o[e.field]))}}function k(i,l){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.hij(" ",o[e.field][e.subField]," ")}}function z(i,l){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.hij(" ",o[e.field]," ")}}function W(i,l){if(1&i&&(t.ynx(0),t.YNc(1,q,2,4,"td",18),t.YNc(2,k,2,1,"td",19),t.YNc(3,z,2,1,"td",19),t.BQk()),2&i){const e=l.$implicit;t.xp6(1),t.Q6J("ngIf","boolean"===e.type),t.xp6(1),t.Q6J("ngIf","text"===e.type&&e.subField),t.xp6(1),t.Q6J("ngIf","text"===e.type&&!e.subField)}}function X(i,l){if(1&i&&(t.TgZ(0,"tr",16),t.YNc(1,W,4,3,"ng-container",17),t.qZA()),2&i){const e=l.$implicit,o=t.oxw();t.Q6J("pSelectableRow",e),t.xp6(1),t.Q6J("ngForOf",o.cols)}}const V=function(){return{width:"100%"}};let tt=(()=>{class i{constructor(e,o,s,c,u){this.apiService=e,this.router=o,this.matDialog=s,this.confirmationService=c,this.notificationService=u,this.cols=[{field:"ldapTitle",type:"text",header:"Title",iconClass:"pi-angle-right"},{field:"roleCount",type:"text",header:"Role Count",iconClass:"pi-angle-right"}],this.menuItems=[{label:"Add",icon:"pi pi-user-plus",command:()=>this.add()},{label:"Edit",icon:"pi pi-user-edit",command:()=>this.edit()},{label:"Delete",icon:"pi pi-trash",command:()=>this.delete()},{label:"Back",icon:"pi pi-arrow-circle-left",command:()=>this.backPage()}],this.subject=new g.x}ngOnDestroy(){this.subject.next(!0),this.subject.complete()}ngOnInit(){this.loadData()}loadData(){this.loading=!0,setTimeout(()=>{this.apiService.ldapTitles().pipe((0,h.U)(e=>{this.rows=e.data.rows,this.totalRecords=e.data.records,this.loading=!1}),(0,f.R)(this.subject)).subscribe()},10)}add(){this.matDialog.open(E,{width:"40%"}).afterClosed().subscribe(o=>{console.log(`Dialog result: ${o}`),o&&this.loadData()})}delete(){this.checkRowSelected(),this.confirmationService.confirm({message:"Do you want to remove selected users?",accept:()=>{this.apiService.deleteLdapTitle(this.selectedRow.ldapTitle).pipe((0,T.b)(e=>{this.notificationService.show(e),this.loadData()}),(0,v.K)(e=>(this.notificationService.show(e.data.message),(0,x._)(()=>e))),(0,f.R)(this.subject)).subscribe()}})}edit(){this.checkRowSelected(),this.matDialog.open(B,{width:"40%",data:{title:this.selectedRow?this.selectedRow.ldapTitle:null}}).afterClosed().subscribe(o=>{console.log(`Dialog result: ${o}`),o&&this.loadData()})}checkRowSelected(){if(!this.selectedRow)throw this.notificationService.error("Please select a row"),Error("Please select a row")}backPage(){return this.router.navigateByUrl("/admin/roles")}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(b.N),t.Y36(J.F0),t.Y36(r.uw),t.Y36(C.YP),t.Y36(Z.g))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-ldap-title"]],decls:10,vars:11,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex-auto","p-6","sm:p-10"],[1,"flex"],[1,"text-3xl","font-bold","mt-0","mb-6"],["dataKey","ldapTitle","scrollDirection","horizontal","selectionMode","single",3,"value","lazy","paginator","scrollable","selection","rows","totalRecords","loading","selectionChange"],["dt2",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"flex",2,"justify-content","space-between"],["type","button","pButton","","icon","pi pi-angle-double-down","label","Actions",1,"ml-auto","p-button-rounded","p-button-sm",3,"click"],["appendTo","body",3,"popup","model"],["menu",""],[3,"pSortableColumn",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field"],[3,"pSelectableRow"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","truncate",4,"ngIf"],[1,"pi",3,"ngClass"],[1,"truncate"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),t._uU(4,"Ldap Title List"),t.qZA()(),t.TgZ(5,"p-table",4,5),t.NdJ("selectionChange",function(c){return o.selectedRow=c}),t.YNc(7,K,4,2,"ng-template",6),t.YNc(8,G,2,1,"ng-template",7),t.YNc(9,X,2,2,"ng-template",8),t.qZA()()()),2&e&&(t.xp6(5),t.Akn(t.DdM(10,V)),t.Q6J("value",o.rows)("lazy",!1)("paginator",!0)("scrollable",!0)("selection",o.selectedRow)("rows",10)("totalRecords",o.totalRecords)("loading",o.loading))},dependencies:[d.mk,d.sg,d.O5,m.iA,C.jx,m.lQ,m.Ei,m.fz,N.Hq,I.v2],encapsulation:2}),i})();var et=n(4466);const it=[{path:"",component:tt}];let ot=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[d.ez,J.Bz.forChild(it),m.U$,N.hJ,I.$9,a.UX,p.lN,et.m,Y.f,_.c,r.Is,L.ot,U.q4]}),i})()}}]);