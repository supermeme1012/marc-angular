"use strict";(self.webpackChunkriskanalysis=self.webpackChunkriskanalysis||[]).push([[453],{9453:(Vt,w,s)=>{s.r(w),s.d(w,{ReportingModule:()=>Bt});var m=s(6895),b=s(2510),x=s(7579),v=s(4004),f=s(2722),C=s(8505),Z=s(262),S=s(2843),c=s(5412),t=s(4650),I=s(529);let T=(()=>{class i{constructor(e){this.httpClient=e}list(e){return this.httpClient.get("reportingUnit/getReportingUnits?",{params:new I.LE({fromObject:{...e}})})}dashboard(){return this.httpClient.get("reportingUnit/dashboardData")}saveFirst(e){return this.httpClient.post("reportingUnit/validateDbConnectionWizard",e)}saveSecond(e){return this.httpClient.post("reportingUnit/wizardOperations",e)}delete(e){return this.httpClient.get(`reportingUnit/deleteRU?id=${e}`)}update(e,n){return this.httpClient.post("reportingUnit/saveEdit",n)}detail(e){return this.httpClient.get(`admin/reportUnitusers/${e}`)}initForm(){return this.httpClient.get("reportingUnit/loadAddWizard")}initFormForUpdate(e){return this.httpClient.get(`reportingUnit/loadEdit?id=${e}`)}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(I.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var A=s(7404),u=s(403),y=s(805),U=s(4859);function H(i,r){1&i&&(t.TgZ(0,"h2",9),t._uU(1,"Report Unit Details"),t.qZA())}function V(i,r){if(1&i&&(t.TgZ(0,"th",11),t._uU(1),t._UZ(2,"p-sortIcon",12),t.qZA()),2&i){const e=r.$implicit;t.s9C("pSortableColumn",e.field),t.xp6(1),t.hij(" ",e.header," "),t.xp6(1),t.s9C("field",e.field)}}function K(i,r){if(1&i&&(t.TgZ(0,"tr"),t.YNc(1,V,3,3,"th",10),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.selectedColumns)}}function W(i,r){if(1&i&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n[e.field]," ")}}const X=function(i,r){return{"true-icon pi-check-circle":i,"false-icon pi-times-circle":r}};function tt(i,r){if(1&i&&(t.TgZ(0,"td"),t._UZ(1,"i",15),t.qZA()),2&i){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngClass",t.WLB(1,X,e.enabled,!e.enabled))}}function et(i,r){if(1&i&&(t.YNc(0,W,2,1,"td",0),t.YNc(1,tt,2,4,"td",0)),2&i){const e=r.$implicit;t.Q6J("ngIf","enabled"!==e.field),t.xp6(1),t.Q6J("ngIf","enabled"===e.field)}}function it(i,r){if(1&i&&(t.TgZ(0,"tr",13),t.YNc(1,et,2,2,"ng-template",14),t.qZA()),2&i){const e=r.$implicit,n=t.oxw(2);t.Q6J("pSelectableRow",e),t.xp6(1),t.Q6J("ngForOf",n.selectedColumns)}}function nt(i,r){if(1&i&&(t.ynx(0),t.TgZ(1,"mat-dialog-content",1)(2,"p-table",2,3),t.YNc(4,H,2,0,"ng-template",4),t.YNc(5,K,2,1,"ng-template",5),t.YNc(6,it,2,2,"ng-template",6),t.qZA()(),t.TgZ(7,"mat-dialog-actions",7)(8,"button",8),t._uU(9,"Cancel"),t.qZA()(),t.BQk()),2&i){const e=t.oxw();t.xp6(2),t.Q6J("value",e.users)}}let ot=(()=>{class i{constructor(e,n,o,a){this.dialogData=e,this.apiService=n,this.notificationService=o,this.dialogRef=a,this.subject=new x.x,this.cols=[{field:"username",type:"text",header:"Username"},{field:"firstName",type:"text",header:"First Name"},{field:"lastName",type:"text",header:"Last Name"},{field:"email",type:"text",header:"Email"}],this.selectedColumns=this.cols}ngOnInit(){this.reportingUnit=this.dialogData.reportingUnit,this.initDetail()}initDetail(){this.apiService.detail(this.reportingUnit.id).pipe((0,v.U)(e=>{e.success?this.users=e.data:this.notificationService.show(e)}),(0,f.R)(this.subject)).subscribe()}ngOnDestroy(){this.subject.next(!0),this.subject.complete()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(c.WI),t.Y36(T),t.Y36(A.g),t.Y36(c.so))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-reporting-detail"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"mat-typography"],["dataKey","id","styleClass","p-datatable-gridlines",3,"value"],["dt2",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["align","end"],["mat-button","","mat-dialog-close",""],["mat-dialog-title",""],[3,"pSortableColumn",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field"],[3,"pSelectableRow"],["ngFor","",3,"ngForOf"],[1,"pi",3,"ngClass"]],template:function(e,n){1&e&&t.YNc(0,nt,10,1,"ng-container",0),2&e&&t.Q6J("ngIf",n.users)},dependencies:[m.mk,m.sg,m.O5,u.iA,y.jx,u.lQ,u.Ei,u.fz,c.ZT,c.uh,c.xY,c.H8,U.lW]}),i})();var l=s(4006),D=s(9439),J=s(6284),_=s(9549),F=s(4385),q=s(3238),O=s(8271),R=s(4144),h=s(6257),k=s(1149);function rt(i,r){1&i&&t._uU(0,"New DB Details")}function at(i,r){1&i&&t._uU(0,"Reporting Unit")}function st(i,r){if(1&i&&(t.TgZ(0,"div",45)(1,"div",46)(2,"span",47),t._uU(3),t.qZA()()()),2&i){const e=r.$implicit;t.xp6(3),t.Oqu(e.destinationName)}}function lt(i,r){if(1&i&&(t.TgZ(0,"mat-option",19),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.text," ")}}function pt(i,r){1&i&&t._uU(0,"Process")}function ct(i,r){1&i&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"Action"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Status"),t.qZA()())}function mt(i,r){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA()()),2&i){const e=r.$implicit;t.xp6(2),t.Oqu(e.key),t.xp6(2),t.Oqu(e.value)}}function dt(i,r){if(1&i&&(t.TgZ(0,"p-table",19),t.YNc(1,ct,5,0,"ng-template",48),t.YNc(2,mt,5,2,"ng-template",49),t.qZA()),2&i){const e=t.oxw(2);t.Q6J("value",e.resultTable)}}const E=function(){return{height:"20rem"}};function ut(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"mat-dialog-content",7)(2,"mat-stepper",8,9)(4,"mat-step",10)(5,"form",11),t.YNc(6,rt,1,0,"ng-template",12),t.TgZ(7,"div",13)(8,"mat-form-field")(9,"mat-label"),t._uU(10,"Connection Name"),t.qZA(),t._UZ(11,"input",14),t.TgZ(12,"mat-error"),t._UZ(13,"form-error",15),t.qZA()(),t.TgZ(14,"mat-form-field")(15,"mat-label"),t._uU(16,"Description"),t.qZA(),t._UZ(17,"input",16),t.TgZ(18,"mat-error"),t._UZ(19,"form-error",17),t.qZA()(),t.TgZ(20,"mat-form-field")(21,"mat-label"),t._uU(22,"Database Type"),t.qZA(),t.TgZ(23,"mat-select",18)(24,"mat-option",19),t._uU(25," Please Select "),t.qZA(),t.TgZ(26,"mat-option",19),t._uU(27," MySQL "),t.qZA()(),t._UZ(28,"input",20),t.TgZ(29,"mat-error"),t._UZ(30,"form-error",21),t.qZA()(),t.TgZ(31,"mat-form-field")(32,"mat-label"),t._uU(33,"DBHost Name"),t.qZA(),t._UZ(34,"input",22),t.TgZ(35,"mat-error"),t._UZ(36,"form-error",23),t.qZA()(),t.TgZ(37,"mat-form-field")(38,"mat-label"),t._uU(39,"Database"),t.qZA(),t._UZ(40,"input",24),t.TgZ(41,"mat-error"),t._UZ(42,"form-error",25),t.qZA()(),t.TgZ(43,"mat-form-field")(44,"mat-label"),t._uU(45,"Username"),t.qZA(),t._UZ(46,"input",26),t.TgZ(47,"mat-error"),t._UZ(48,"form-error",27),t.qZA()(),t.TgZ(49,"mat-form-field")(50,"mat-label"),t._uU(51,"Password"),t.qZA(),t._UZ(52,"input",28),t.TgZ(53,"mat-error"),t._UZ(54,"form-error",29),t.qZA()()()(),t.TgZ(55,"div",30)(56,"button",31),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.saveFirst())}),t._uU(57,"Next "),t.qZA()()(),t.TgZ(58,"mat-step",32)(59,"form",11),t.YNc(60,at,1,0,"ng-template",12),t.TgZ(61,"div",13)(62,"mat-form-field")(63,"mat-label"),t._uU(64,"ReportingUnit"),t.qZA(),t._UZ(65,"input",14),t.TgZ(66,"mat-error"),t._UZ(67,"form-error",15),t.qZA()(),t.TgZ(68,"div",33)(69,"label"),t._uU(70,"Select Sap Systems"),t.qZA(),t.TgZ(71,"p-pickList",34),t.YNc(72,st,4,1,"ng-template",35),t.qZA()(),t.TgZ(73,"mat-form-field")(74,"mat-label"),t._uU(75,"Notification Scope"),t.qZA(),t.TgZ(76,"mat-select",36),t.YNc(77,lt,2,2,"mat-option",37),t.qZA(),t.TgZ(78,"mat-error"),t._UZ(79,"form-error",38),t.qZA()()()(),t.TgZ(80,"div",39)(81,"button",40),t._uU(82,"Back"),t.qZA(),t.TgZ(83,"button",41),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.saveSecond())}),t._uU(84,"Next "),t.qZA()()(),t.TgZ(85,"mat-step")(86,"form",42),t.YNc(87,pt,1,0,"ng-template",12),t.TgZ(88,"div",13),t.YNc(89,dt,3,1,"p-table",43),t.qZA()(),t.TgZ(90,"div",39)(91,"button",40),t._uU(92,"Back"),t.qZA(),t.TgZ(93,"button",44),t._uU(94,"Finish "),t.qZA()()()()(),t.BQk()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("linear",!0),t.xp6(2),t.Q6J("stepControl",e.firstFormGroup)("optional",!1),t.xp6(1),t.Q6J("formGroup",e.firstFormGroup),t.xp6(8),t.Q6J("form",e.firstFormGroup),t.xp6(6),t.Q6J("form",e.firstFormGroup),t.xp6(7),t.Q6J("value","com.mysql.cj.jdbc.Driver"),t.xp6(4),t.Q6J("form",e.firstFormGroup),t.xp6(6),t.Q6J("form",e.firstFormGroup),t.xp6(6),t.Q6J("form",e.firstFormGroup),t.xp6(6),t.Q6J("form",e.firstFormGroup),t.xp6(6),t.Q6J("form",e.firstFormGroup),t.xp6(2),t.Q6J("disabled",!e.firstFormGroup.valid),t.xp6(2),t.Q6J("stepControl",e.secondFormGroup),t.xp6(1),t.Q6J("formGroup",e.secondFormGroup),t.xp6(8),t.Q6J("form",e.secondFormGroup),t.xp6(4),t.Q6J("source",e.sapSystems)("target",e.targetSapSystems)("dragdrop",!0)("responsive",!0)("sourceStyle",t.DdM(26,E))("targetStyle",t.DdM(27,E)),t.xp6(6),t.Q6J("ngForOf",e.yesNoFields),t.xp6(2),t.Q6J("form",e.secondFormGroup),t.xp6(4),t.Q6J("disabled",!e.secondFormGroup.valid),t.xp6(6),t.Q6J("ngIf",e.resultTable)}}function gt(i,r){1&i&&t._uU(0,"Please wait...")}let Q=(()=>{class i{constructor(e,n,o,a,p,d){this.dialogData=e,this.reportingService=n,this.passwordService=o,this.formBuilder=a,this.formValidation=p,this.dialogRef=d,this.subject=new x.x,this.title="Add Reporting Unit",this.yesNoFields=[{value:null,text:"Please select"},{value:!0,text:"YES"},{value:!1,text:"NO"}],this.types=[{value:!0,text:"Offline"},{value:!1,text:"Online"}],this.timezones=[],this.systemRoles=[],this.targetSapSystems=[],this.resultTable=[]}ngOnInit(){this.initFormFields()}initFormFields(){let e=this.reportingService.initForm();this.reportingId&&(e=this.reportingService.initFormForUpdate(this.reportingId)),this.form$=e.pipe((0,v.U)(n=>(this.sapSystems=n.data.sapSystems,this.createFirstForm(),this.createSecondForm())))}createFirstForm(){return this.firstFormGroup=this.formBuilder.group({name:["",[l.kI.required]],description:[""],driverClassName:["",[l.kI.required]],dbHost:["",[l.kI.required]],dataBase:["",[l.kI.required]],userName:["",[l.kI.required]],password:["",[l.kI.required]]}),this.firstFormGroup}createSecondForm(){return this.secondFormGroup=this.formBuilder.group({name:["",[l.kI.required]],notificationScope:["",[l.kI.required]],sapSystemIds:[""]}),this.secondFormGroup}saveFirst(){this.reportingService.saveFirst({reportingUnit:{},dbConnection:this.firstFormGroup.value}).pipe((0,C.b)(n=>{}),(0,Z.K)(n=>(this.formValidation.validateAllFields(this.firstFormGroup,n.error.data),(0,S._)(()=>n))),(0,f.R)(this.subject)).subscribe()}saveSecond(){this.secondFormGroup.value.sapSystemIds=this.targetSapSystems.map(n=>n.id),this.reportingService.saveSecond({reportingUnit:this.secondFormGroup.value,dbConnection:this.firstFormGroup.value}).pipe((0,C.b)(n=>{const o=n.message.split(";");this.resultTable=[],this.resultTable.push({key:"Database Creation",value:o[0]}),this.resultTable.push({key:"Structure Setup",value:o[1]}),this.resultTable.push({key:"Setup Reporting",value:o[2]}),this.resultTable.push({key:"Connect DB",value:o[3]})}),(0,Z.K)(n=>(this.formValidation.validateAllFields(this.secondFormGroup,n.error.data),(0,S._)(()=>n))),(0,f.R)(this.subject)).subscribe()}ngOnDestroy(){this.subject.next(!0),this.subject.complete()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(c.WI),t.Y36(T),t.Y36(D.C),t.Y36(l.qu),t.Y36(J.m),t.Y36(c.so))},i.\u0275cmp=t.Xpm({type:i,selectors:[["add-reporting"]],decls:11,vars:5,consts:[[1,"w-full","md:w-auto","max-w-full"],[1,"flex","justify-between"],["mat-dialog-title","",1,"flex"],[1,"flex"],["mat-button","","mat-flat-button","","mat-dialog-close",""],[4,"ngIf","ngIfElse"],["loading",""],[1,"mat-typography"],[3,"linear"],["stepper",""],[3,"stepControl","optional"],[1,"mt-8",3,"formGroup"],["matStepLabel",""],[1,"flex","flex-col","col-span-2","flex-auto","p-6"],["matInput","","type","text","formControlName","name"],["name","name",3,"form"],["matInput","","type","text","formControlName","description"],["name","description",3,"form"],["formControlName","driverClassName"],[3,"value"],["matInput","","type","text","formControlName","driverClassName"],["name","driverClassName",3,"form"],["matInput","","type","text","formControlName","dbHost"],["name","dbHost",3,"form"],["matInput","","type","text","formControlName","dataBase"],["name","dataBase",3,"form"],["matInput","","type","text","formControlName","userName"],["name","userName",3,"form"],["matInput","","type","password","formControlName","password"],["name","password",3,"form"],[1,"flex","justify-end"],["mat-button","","matStepperNext","",1,"",3,"disabled","click"],[3,"stepControl"],[1,"flex","flex-col","mb-5"],["sourceHeader","Available","targetHeader","Selected","filterBy","destinationName","sourceFilterPlaceholder","Search by name","targetFilterPlaceholder","Search by name",3,"source","target","dragdrop","responsive","sourceStyle","targetStyle"],["pTemplate","item"],["formControlName","notificationScope"],[3,"value",4,"ngFor","ngForOf"],["name","notificationScope",3,"form"],[1,"mt-3"],["mat-button","","matStepperPrevious",""],["mat-button","","matStepperNext","",3,"disabled","click"],[1,"mt-8"],[3,"value",4,"ngIf"],["mat-button","","mat-dialog-close",""],[1,"product-item"],[1,"product-list-detail"],[1,"mb-2"],["pTemplate","header"],["pTemplate","body"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),t._uU(3),t.qZA(),t.TgZ(4,"div",3)(5,"button",4),t._uU(6,"Close"),t.qZA()()(),t.YNc(7,ut,95,28,"ng-container",5),t.ALo(8,"async"),t.YNc(9,gt,1,0,"ng-template",null,6,t.W1O),t.qZA()),2&e){const o=t.MAs(10);t.xp6(3),t.Oqu(n.title),t.xp6(4),t.Q6J("ngIf",t.lcZ(8,3,n.form$))("ngIfElse",o)}},dependencies:[m.sg,m.O5,u.iA,y.jx,l._Y,l.Fj,l.JJ,l.JL,l.F,c.ZT,c.uh,c.xY,U.lW,l.sg,l.u,_.TO,_.KE,_.hX,F.gD,q.ey,O.A,R.Nt,h.C0,h.VY,h.Vq,h.Ic,h.fd,k.G,m.Ov],styles:[".mat-form-field.mat-form-field-appearance-fill.mat-form-field-has-label .mat-form-field-wrapper{margin-top:12px!important}  .mat-dialog-content{max-height:inherit}  .p-picklist-buttons.p-picklist-source-controls{display:none}  .p-picklist-buttons.p-picklist-target-controls{display:none}"],changeDetection:0}),i})();function ft(i,r){if(1&i&&(t.TgZ(0,"div",25)(1,"div",26)(2,"span",27),t._uU(3),t.qZA()()()),2&i){const e=r.$implicit;t.xp6(3),t.Oqu(e.destinationName)}}function _t(i,r){if(1&i&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function ht(i,r){if(1&i&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.text," ")}}function xt(i,r){if(1&i&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.text," ")}}const L=function(){return{height:"10rem"}};function vt(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"mat-dialog-content",7)(2,"form",8)(3,"div",9)(4,"mat-form-field")(5,"mat-label"),t._uU(6,"ReportingUnit"),t.qZA(),t._UZ(7,"input",10),t.TgZ(8,"mat-error"),t._UZ(9,"form-error",11),t.qZA()(),t.TgZ(10,"div",12)(11,"label"),t._uU(12,"Select Sap Systems"),t.qZA(),t.TgZ(13,"p-pickList",13),t.YNc(14,ft,4,1,"ng-template",14),t.qZA()(),t.TgZ(15,"mat-form-field")(16,"mat-label"),t._uU(17,"Db Connection"),t.qZA(),t.TgZ(18,"mat-select",15)(19,"mat-option",16),t._uU(20," Please Select "),t.qZA(),t.YNc(21,_t,2,2,"mat-option",17),t.qZA(),t.TgZ(22,"mat-error"),t._UZ(23,"form-error",18),t.qZA()(),t.TgZ(24,"mat-form-field")(25,"mat-label"),t._uU(26,"Notification Scope"),t.qZA(),t.TgZ(27,"mat-select",19),t.YNc(28,ht,2,2,"mat-option",17),t.qZA(),t.TgZ(29,"mat-error"),t._UZ(30,"form-error",20),t.qZA()(),t.TgZ(31,"mat-form-field")(32,"mat-label"),t._uU(33,"Expired SOD Jobs Deletion"),t.qZA(),t.TgZ(34,"mat-select",21),t.YNc(35,xt,2,2,"mat-option",17),t.qZA(),t.TgZ(36,"mat-error"),t._UZ(37,"form-error",22),t.qZA()()()()(),t.TgZ(38,"mat-dialog-actions",23)(39,"button",24),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.update())}),t._uU(40,"Save Changes"),t.qZA()(),t.BQk()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("formGroup",e.form),t.xp6(7),t.Q6J("form",e.form),t.xp6(4),t.Q6J("source",e.sapSystems)("target",e.targetSapSystems)("dragdrop",!0)("responsive",!0)("sourceStyle",t.DdM(15,L))("targetStyle",t.DdM(16,L)),t.xp6(8),t.Q6J("ngForOf",e.dbConnections),t.xp6(2),t.Q6J("form",e.form),t.xp6(5),t.Q6J("ngForOf",e.yesNoFields),t.xp6(2),t.Q6J("form",e.form),t.xp6(5),t.Q6J("ngForOf",e.yesNoFields),t.xp6(2),t.Q6J("form",e.form),t.xp6(2),t.Q6J("disabled",!e.form.valid)}}function yt(i,r){1&i&&t._uU(0,"Please wait...")}let Y=(()=>{class i{constructor(e,n,o,a,p,d,g,Ht){this.dialogData=e,this.reportingService=n,this.passwordService=o,this.formBuilder=a,this.formValidation=p,this.route=d,this.notificationService=g,this.dialogRef=Ht,this.subject=new x.x,this.title="Edit Reporting Unit",this.yesNoFields=[{value:null,text:"Please select"},{value:!0,text:"YES"},{value:!1,text:"NO"}],this.types=[{value:!0,text:"Offline"},{value:!1,text:"Online"}],this.timezones=[],this.systemRoles=[],this.targetSapSystems=[],this.dbConnections=[]}ngOnInit(){this.reportingId=this.dialogData.reportingId,this.initFormFields()}initFormFields(){this.form$=this.reportingService.initFormForUpdate(this.reportingId).pipe((0,v.U)(e=>(this.dbConnections=e.data.dbConnections,this.form=this.formBuilder.group({id:[e.data.reportingUnit.id],name:[e.data.reportingUnit.name],sapSystemIds:[""],dbConnectionId:[e.data.reportingUnit.dbConnection.id,[l.kI.required]],notificationScope:[e.data.reportingUnit.notificationScope,[l.kI.required]],expiredSODJobsDeletion:[e.data.reportingUnit.expiredSODJobsDeletion,[l.kI.required]]}),this.sapSystems=e.data.sapSystems.filter(n=>!e.data.reportingUnit.sapSystems.map(o=>o.id).includes(n.id)),this.targetSapSystems=e.data.sapSystems.filter(n=>e.data.reportingUnit.sapSystems.map(o=>o.id).includes(n.id)),this.form.controls.name.disable(),this.form)))}update(){const e=this.form.getRawValue();e.sapSystemIds=this.targetSapSystems.map(n=>n.id),this.reportingService.update(this.reportingId,e).pipe((0,C.b)(n=>{this.notificationService.show(n)}),(0,Z.K)(n=>(this.formValidation.validateAllFields(this.form,n.error.data),(0,S._)(()=>n))),(0,f.R)(this.subject)).subscribe()}ngOnDestroy(){this.subject.next(!0),this.subject.complete()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(c.WI),t.Y36(T),t.Y36(D.C),t.Y36(l.qu),t.Y36(J.m),t.Y36(b.gz),t.Y36(A.g),t.Y36(c.so))},i.\u0275cmp=t.Xpm({type:i,selectors:[["edit-reporting"]],decls:11,vars:5,consts:[[1,"flex-auto"],[1,"flex","justify-between"],["mat-dialog-title","",1,"flex"],[1,"flex"],["mat-button","","mat-flat-button","","mat-dialog-close",""],[4,"ngIf","ngIfElse"],["loading",""],[1,"mat-typography"],[1,"mt-8",3,"formGroup"],[1,"flex","flex-col","col-span-2","flex-auto","p-6"],["matInput","","type","text","formControlName","name"],["name","name",3,"form"],[1,"flex","flex-col","mb-5"],["sourceHeader","Available","targetHeader","Selected","filterBy","destinationName","sourceFilterPlaceholder","Search by name","targetFilterPlaceholder","Search by name",3,"source","target","dragdrop","responsive","sourceStyle","targetStyle"],["pTemplate","item"],["formControlName","dbConnectionId"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["name","dbConnectionId",3,"form"],["formControlName","notificationScope"],["name","notificationScope",3,"form"],["formControlName","expiredSODJobsDeletion"],["name","expiredSODJobsDeletion",3,"form"],["align","end"],["mat-button","",3,"disabled","click"],[1,"product-item"],[1,"product-list-detail"],[1,"mb-2"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),t._uU(3),t.qZA(),t.TgZ(4,"div",3)(5,"button",4),t._uU(6,"Close"),t.qZA()()(),t.YNc(7,vt,41,17,"ng-container",5),t.ALo(8,"async"),t.YNc(9,yt,1,0,"ng-template",null,6,t.W1O),t.qZA()),2&e){const o=t.MAs(10);t.xp6(3),t.Oqu(n.title),t.xp6(4),t.Q6J("ngIf",t.lcZ(8,3,n.form$))("ngIfElse",o)}},dependencies:[m.sg,m.O5,y.jx,l._Y,l.Fj,l.JJ,l.JL,c.ZT,c.uh,c.xY,c.H8,U.lW,l.sg,l.u,_.TO,_.KE,_.hX,F.gD,q.ey,O.A,R.Nt,k.G,m.Ov],styles:[".mat-form-field.mat-form-field-appearance-fill.mat-form-field-has-label .mat-form-field-wrapper{margin-top:12px!important}  .mat-dialog-content{max-height:inherit}  .p-picklist-buttons.p-picklist-source-controls{display:none}  .p-picklist-buttons.p-picklist-target-controls{display:none}  .cdk-global-overlay-wrapper{display:flex;position:absolute;z-index:1000;overflow:auto;pointer-events:auto}"],changeDetection:0}),i})();var M=s(5722),j=s(1327),$=s(5593),P=s(9364);const bt=function(){return{minWidth:"200px"}};function Ct(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",18)(1,"p-multiSelect",19),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.selectedColumns=o)}),t.qZA(),t.TgZ(2,"button",20),t.NdJ("click",function(o){t.CHM(e);const a=t.MAs(4);return t.KtG(a.toggle(o))}),t.qZA(),t._UZ(3,"p-menu",21,22),t.qZA()}if(2&i){const e=t.oxw();t.xp6(1),t.Akn(t.DdM(6,bt)),t.Q6J("options",e.cols)("ngModel",e.selectedColumns),t.xp6(2),t.Q6J("popup",!0)("model",e.menuItems)}}const G=function(i){return{width:i}};function Zt(i,r){if(1&i&&(t.TgZ(0,"th",24),t._uU(1),t._UZ(2,"p-sortIcon",25),t.qZA()),2&i){const e=r.$implicit;t.s9C("pSortableColumn",e.field),t.Q6J("ngStyle",t.VKq(4,G,e&&e.width?e.width+"px":"auto")),t.xp6(1),t.hij(" ",e.header," "),t.xp6(1),t.s9C("field",e.field)}}function St(i,r){if(1&i&&(t.TgZ(0,"tr"),t.YNc(1,Zt,3,6,"th",23),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.selectedColumns)}}const Tt=function(i,r){return{"true-icon pi-check-circle":i,"false-icon pi-times-circle":r}};function Ut(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"td",30),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw().$implicit;return t.KtG(o.onClick(a))}),t._UZ(1,"i",31),t.qZA()}if(2&i){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.Q6J("ngStyle",t.VKq(2,G,e&&e.width?e.width+"px":"auto")),t.xp6(1),t.Q6J("ngClass",t.WLB(4,Tt,n[e.field],!n[e.field]))}}function At(i,r){if(1&i&&t._UZ(0,"i"),2&i){const e=t.oxw(2).$implicit;t.Gre("pi ",e.iconClass,"")}}const z=function(i,r){return{width:i,color:r}};function Ft(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"td",32),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw().$implicit;return t.KtG(o.onClick(a))}),t.YNc(1,At,1,3,"i",33),t._uU(2),t.qZA()}if(2&i){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.Q6J("ngStyle",t.WLB(3,z,e&&e.width?e.width+"px":"auto",e&&e.color?e.color:"inherent")),t.xp6(1),t.Q6J("ngIf",e.iconClass),t.xp6(1),t.hij(" ",n[e.field][e.subField]," ")}}function Rt(i,r){if(1&i&&t._UZ(0,"i"),2&i){const e=t.oxw(2).$implicit;t.Gre("pi ",e.iconClass,"")}}function kt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"td",32),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw().$implicit;return t.KtG(o.onClick(a))}),t.YNc(1,Rt,1,3,"i",33),t._uU(2),t.qZA()}if(2&i){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.Q6J("ngStyle",t.WLB(3,z,e&&e.width?e.width+"px":"auto",e&&e.color?e.color:"inherent")),t.xp6(1),t.Q6J("ngIf",e.iconClass),t.xp6(1),t.hij(" ",n[e.field]," ")}}function Nt(i,r){if(1&i&&(t.ynx(0),t.YNc(1,Ut,2,7,"td",28),t.YNc(2,Ft,3,6,"td",29),t.YNc(3,kt,3,6,"td",29),t.BQk()),2&i){const e=r.$implicit;t.xp6(1),t.Q6J("ngIf","boolean"===e.type),t.xp6(1),t.Q6J("ngIf","text"===e.type&&e.subField),t.xp6(1),t.Q6J("ngIf","text"===e.type&&!e.subField)}}function wt(i,r){if(1&i&&(t.TgZ(0,"tr",26),t.YNc(1,Nt,4,3,"ng-container",27),t.qZA()),2&i){const e=r.$implicit,n=t.oxw();t.Q6J("pSelectableRow",e),t.xp6(1),t.Q6J("ngForOf",n.selectedColumns)}}const N=function(){return{width:"60%"}},It=function(){return{width:"100%"}};let Dt=(()=>{class i{constructor(e,n,o,a){this.notificationService=e,this.apiService=n,this.matDialog=o,this.confirmationService=a,this.reportingUnits=[],this.menuItems=[{label:"Add",icon:"pi pi-user-plus",command:()=>this.addSapSystem()},{label:"Edit",icon:"pi pi-user-edit",command:()=>this.editSapSystem()},{label:"Delete",icon:"pi pi-trash",command:()=>this.deleteReporting()}],this.subject=new x.x,this.subjectDashboard=new x.x,this.cols=[{field:"name",type:"text",header:"Name",width:200,color:"#008cf0",iconClass:"pi-angle-right",onClick:p=>this.openDetail(p)},{field:"sapSystemsStr",type:"text",header:"Systems"},{field:"dbConnection",type:"text",subField:"name",header:"Database"},{field:"dbConnection",type:"text",subField:"url",header:"Database URL"},{field:"notificationScope",type:"boolean",header:"Notification Scope"}],this.selectedColumns=this.cols,this.filterColumns=this.cols.filter(p=>"boolean"!==p.type).map(p=>p.field),this.chartOptions={plugins:{tooltip:{enabled:!0},legend:{display:!1}}},this.dailyEventOptions={plugins:{tooltip:{enabled:!0},legend:{display:!1}}}}ngOnInit(){this.apiService.dashboard().pipe((0,v.U)(e=>{this.generateLoginEventChart(e),this.generateNoOfUsersPerRuChart(e),this.generateNoOfSystemsPerRuChart(e),this.generateNoOfActivePassiveChart(e)}),(0,f.R)(this.subjectDashboard)).subscribe()}loadData(e){this.lastTableLazyLoadEvent=e,setTimeout(()=>{this.apiService.list({lazyEvent:JSON.stringify(e)}).pipe((0,v.U)(n=>{this.reportingUnits=n.data.rows,this.totalRecords=n.data.records,this.loading=!1}),(0,f.R)(this.subject)).subscribe()},10)}generateLoginEventChart(e){const n=Array.from(Object.entries(e.data.loginEventsMap)).filter(([a,p])=>p>0),o=[];n.forEach(()=>o.push("#"+(16777215*Math.random()<<0).toString(16).padStart(6,"0"))),this.dailyEvents={labels:n.map(a=>a[0]),datasets:[{label:"Event",data:n.map(a=>a[1]),backgroundColor:o}]}}generateNoOfUsersPerRuChart(e){const n=Array.from(Object.entries(e.data.usersPerRUMap)).filter(([a,p])=>p>0),o=[];n.forEach(()=>o.push("#"+(16777215*Math.random()<<0).toString(16).padStart(6,"0"))),this.chartUsersPerRUMap={labels:n.map(a=>a[0]),datasets:[{data:n.map(a=>a[1]),backgroundColor:o}]}}generateNoOfSystemsPerRuChart(e){const n=Array.from(Object.entries(e.data.systemsPerRUMap)).filter(([a,p])=>p>0),o=[];n.forEach(()=>o.push("#"+(16777215*Math.random()<<0).toString(16).padStart(6,"0"))),this.chartSystemsPerRUMap={labels:n.map(a=>a[0]),datasets:[{data:n.map(a=>a[1]),backgroundColor:o}]}}generateNoOfActivePassiveChart(e){const n=Array.from(Object.entries(e.data.usersMap)).filter(([a,p])=>p>0),o=[];n.forEach(()=>o.push("#"+(16777215*Math.random()<<0).toString(16).padStart(6,"0"))),this.chartActivePassiveUsers={labels:n.map(a=>a[0]),datasets:[{data:n.map(a=>a[1]),backgroundColor:o}]}}openDetail(e){this.matDialog.open(ot,{width:"60%",data:{reportingUnit:e}})}addSapSystem(){this.selectedRow=null,this.showAddReportingUnitComponent()}showAddReportingUnitComponent(){this.matDialog.open(Q,{width:"40%"}).afterClosed().subscribe(n=>{console.log(`Dialog result: ${n}`),this.loadData(this.lastTableLazyLoadEvent),this.selectedRow=null})}editSapSystem(){this.checkSelected(),this.matDialog.open(Y,{width:"40%",data:{reportingId:this.selectedRow?this.selectedRow.id:null}}).afterClosed().subscribe(n=>{console.log(`Dialog result: ${n}`),this.loadData(this.lastTableLazyLoadEvent),this.selectedRow=null})}checkSelected(){if(!this.selectedRow)throw this.notificationService.error("Please select a system"),Error("Please select a system")}deleteReporting(){this.checkSelected(),this.confirmationService.confirm({message:"Do you want to remove selected reporting unit?",accept:()=>{this.apiService.delete(this.selectedRow.id).pipe((0,C.b)(e=>{this.notificationService.show(e),this.loadData(this.lastTableLazyLoadEvent)}),(0,Z.K)(e=>(this.notificationService.show(e.data.message),(0,S._)(()=>e))),(0,f.R)(this.subject)).subscribe()}})}ngOnDestroy(){this.subject.next(!0),this.subject.complete(),this.subjectDashboard.next(!0),this.subjectDashboard.complete()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(A.g),t.Y36(T),t.Y36(c.uw),t.Y36(y.YP))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-reporting"]],decls:33,vars:29,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex-auto","p-6","sm:p-10"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-4","gap-6","w-full","min-w-0","ng-star-inserted"],[1,"flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"text-lg","font-medium","tracking-tight","leading-6","truncate"],[1,"flex","flex-col","items-center","mt-2"],["type","bar",3,"data","options"],[1,"text-lg","font-medium","tracking-tight","text-center","leading-6","truncate"],["type","doughnut",3,"data","options"],[1,"sm:col-span-2","md:col-span-4","flex","flex-col","flex-auto","p-6","bg-card","shadow","rounded-2xl","overflow-hidden"],[1,"grid","grid-cols-1","grid-flow-row","gap-6","w-full","mt-8","sm:mt-4"],[1,"text-xl","font-medium","tracking-tight","leading-6","truncate"],[1,"flex","flex-col","flex-auto"],["dataKey","name","scrollDirection","horizontal","selectionMode","single",3,"value","lazy","paginator","scrollable","selection","globalFilterFields","rows","totalRecords","loading","onLazyLoad","selectionChange"],["dt2",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"flex",2,"justify-content","space-between"],["optionLabel","header","selectedItemsLabel","{0} columns selected","placeholder","Choose Columns",3,"options","ngModel","ngModelChange"],["type","button","pButton","","icon","pi pi-angle-double-down","label","Actions",1,"ml-auto","p-button-rounded","p-button-sm",3,"click"],["appendTo","body",3,"popup","model"],["menu",""],[3,"pSortableColumn","ngStyle",4,"ngFor","ngForOf"],[3,"pSortableColumn","ngStyle"],[3,"field"],[3,"pSelectableRow"],[4,"ngFor","ngForOf"],[3,"ngStyle","click",4,"ngIf"],["class","truncate",3,"ngStyle","click",4,"ngIf"],[3,"ngStyle","click"],[1,"pi",3,"ngClass"],[1,"truncate",3,"ngStyle","click"],[3,"class",4,"ngIf"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t._uU(5,"User Login Events for past 10 days "),t.qZA(),t.TgZ(6,"div",5),t._UZ(7,"p-chart",6),t.qZA()(),t.TgZ(8,"div",3)(9,"div",7),t._uU(10,"No of Users Per RU"),t.qZA(),t.TgZ(11,"div",5),t._UZ(12,"p-chart",8),t.qZA()(),t.TgZ(13,"div",3)(14,"div",7),t._uU(15,"No of Systems Per RU "),t.qZA(),t.TgZ(16,"div",5),t._UZ(17,"p-chart",8),t.qZA()(),t.TgZ(18,"div",3)(19,"div",7),t._uU(20,"No of Active/Disabled Users "),t.qZA(),t.TgZ(21,"div",5),t._UZ(22,"p-chart",8),t.qZA()(),t.TgZ(23,"div",9)(24,"div",10)(25,"div",11),t._uU(26,"Reporting Units"),t.qZA(),t.TgZ(27,"div",12)(28,"p-table",13,14),t.NdJ("onLazyLoad",function(a){return n.loadData(a)})("selectionChange",function(a){return n.selectedRow=a}),t.YNc(30,Ct,5,7,"ng-template",15),t.YNc(31,St,2,1,"ng-template",16),t.YNc(32,wt,2,2,"ng-template",17),t.qZA()()()()()()()),2&e&&(t.xp6(7),t.Q6J("data",n.dailyEvents)("options",n.dailyEventOptions),t.xp6(5),t.Akn(t.DdM(25,N)),t.Q6J("data",n.chartUsersPerRUMap)("options",n.chartOptions),t.xp6(5),t.Akn(t.DdM(26,N)),t.Q6J("data",n.chartSystemsPerRUMap)("options",n.chartOptions),t.xp6(5),t.Akn(t.DdM(27,N)),t.Q6J("data",n.chartActivePassiveUsers)("options",n.chartOptions),t.xp6(6),t.Akn(t.DdM(28,It)),t.Q6J("value",n.reportingUnits)("lazy",!0)("paginator",!0)("scrollable",!0)("selection",n.selectedRow)("globalFilterFields",n.filterColumns)("rows",10)("totalRecords",n.totalRecords)("loading",n.loading))},dependencies:[m.mk,m.sg,m.O5,m.PC,u.iA,y.jx,u.lQ,u.Ei,u.fz,M.NU,j.v2,l.JJ,l.On,$.Hq,P.C]}),i})();var Jt=s(7392),qt=s(5655),Ot=s(4466),B=s(3608);let Gt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[m.ez,b.Bz,B.z,b.Bz,B.z]}),i})();const zt=[{path:"",component:Dt},{path:"add",component:Q},{path:"edit",component:Y}];let Bt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[b.Bz.forChild(zt),m.ez,u.U$,M.q4,j.$9,l.u5,$.hJ,c.Is,U.ot,Jt.Ps,qt.Tx,P.S,l.UX,_.lN,F.LD,Ot.m,R.c,Gt,h.T5,k.f]}),i})()}}]);